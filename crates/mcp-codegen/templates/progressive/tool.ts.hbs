#!/usr/bin/env node
/**
 * @tool {{name}}
 * @server {{server_id}}
{{#if category}}
 * @category {{category}}
{{/if}}
 */
import { callMCPTool } from './_runtime/mcp-bridge.ts';

/**
 * {{description}}
{{#if input_schema.description}}
 *
 * {{input_schema.description}}
{{/if}}
{{#if category}}
 *
 * @category {{category}}
{{/if}}
 *
 * @param params - Tool parameters
 * @returns Tool execution result
 * @throws {Error} If tool execution fails
 */
export async function {{typescript_name}}(
  params: {{typescript_name}}Params
): Promise<{{typescript_name}}Result> {
  return await callMCPTool('{{server_id}}', '{{name}}', params);
}

/**
 * Parameters for {{typescript_name}} tool.
{{#if input_schema.description}}
 *
 * {{input_schema.description}}
{{/if}}
 */
export interface {{typescript_name}}Params {
{{#each properties}}
  {{#if description}}
  /**
   * {{description}}
   */
  {{/if}}
{{#if required}}
  {{name}}: {{{typescript_type}}};
{{else}}
  {{name}}?: {{{typescript_type}}};
{{/if}}
{{/each}}
}

/**
 * Result type for {{typescript_name}} tool.
 *
 * The structure of the result depends on the specific tool implementation.
 * Refer to the MCP server documentation for details.
 */
export interface {{typescript_name}}Result {
  [key: string]: unknown;
}

// CLI mode: Execute when run directly
// This enables autonomous execution via: node {{typescript_name}}.ts '{"param":"value"}'
if (import.meta.url === `file://${process.argv[1]}`) {
  (async () => {
    try {
      // Parse parameters from command line argument
      const params = JSON.parse(process.argv[2] || '{}');

      // Execute the tool
      const result = await {{typescript_name}}(params as {{typescript_name}}Params);

      // Output result as JSON
      console.log(JSON.stringify(result, null, 2));
      process.exit(0);
    } catch (error) {
      // Output error as JSON
      const errorObj = error instanceof Error
        ? { error: error.message, stack: error.stack }
        : { error: String(error) };

      console.error(JSON.stringify(errorObj, null, 2));
      process.exit(1);
    }
  })();
}
